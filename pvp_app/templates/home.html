{% extends 'base.html' %}
{% block content %}
  {% if pokemon %}
  <!-- redirect to results part of page -->
  <script>
    window.location.href = '#results-link';
  </script>
  {% endif %}
  <h2 id="welcome-link">welcome</h2>
  <a href="#results-link">Results</a>
  <p>
    <form action="{% url 'home' %}">
      <button type="submit" class="reset btn btn-warning">Reset</button>
    </form>
  </p>
    <form method="POST" action="{% url 'analyze' %}">
      {% csrf_token %}


      <label for="pokemon">Pokemon</label>
      <input type="text" list="auto-pokemon" id="pokemon" name="pokemon" autofocus required value="{{ pokemon }}">
      <datalist id="auto-pokemon"></datalist>

      <label for="evo-pokemon">Evolution</label>
      <input type="text" list="auto-evo-pokemon" id="evo-pokemon" name="evo-pokemon" required value="{{ evolution }}">
      <datalist id="auto-evo-pokemon"></datalist>
      
    
      <div class="IVInputsContainer">
      {% if pokemon %}
        {% for result in results %}
        <div class="IVs">
          {% if not result.inputs.is_valid %}
          <div class="invalidCombo">
            <h3>Wrong CP & IV combination</h3>
          </div>
          {% endif %}
          <button type="button" class="delete btn btn-danger" tabindex="-1" >-</button>
          <label for="cp">CP</label>
          <input type="number" id="cp" name="cp" value="{{ result.inputs.cp }}">
          
          <label for="attack">Attack IV</label>
          <input type="number" id="attack" name="attack" value="{{ result.inputs.attack }}">
          
          <label for="defense">Defense IV</label>
          <input type="number" id="defense" name="defense" value="{{ result.inputs.defense }}">

          <label for="stamina">Stamina IV</label>
          <input type="number" id="stamina" name="stamina" value="{{ result.inputs.stamina }}">
        </div>
        {% endfor %}
      {% else %}
        <div class="IVs">
          <!-- delete button that's disabled for first row -->
          <button type="button" class="delete btn btn-danger" tabindex="-1" disabled>-</button>
          <label for="cp">CP</label>
          <input type="number" id="cp" name="cp">

          <label for="attack">Attack IV</label>
          <input type="number" id="attack" name="attack" >
          
          <label for="defense">Defense IV</label>
          <input type="number" id="defense" name="defense" >

          <label for="stamina">Stamina IV</label>
          <input type="number" id="stamina" name="stamina" >
        </div>
      {% endif %}
      </div>

      <div class="league_choices">
        <label for="GL">Great League</label>
        <input type="checkbox" name="GL" id="GL" value="true">

        <label for="UL">Ultra League</label>
        <input type="checkbox" name="UL" id="UL" value="true">

        <label for="ML">Master League</label>
        <input type="checkbox" name="ML" id="ML" value="true">
      </div>

      <button type="button" class="btn btn-info" id="add">Add</button>
      <button type="submit" class="btn btn-success analyze">Analyze</button>


    </form>
  <div id="results-link">
    <h3 >results</h3>
    {% if pokemon %}
      <h4>{{ pokemon }} --> {{ evolution }}</h4>
      {% for result in results %}
        <div class="row border">
          <div class="col">CP: {{ result.inputs.cp }}</div>
          <div class="col">A: {{ result.inputs.attack }}</div>
          <div class="col">D: {{ result.inputs.defense }}</div>
          <div class="col">S: {{ result.inputs.stamina}}</div>
          <div class="col">Starting Level {{ result.power_up.GL.starting_level }}</div>
        </div>
        <!-- <div class="row border">
          <div class="col">{{ result.inputs.cp }}</div>
          <div class="col">{{ result.inputs.attack }}</div>
          <div class="col">{{ result.inputs.defense }}</div>
          <div class="col">{{ result.inputs.stamina }}</div>
          <div class="col">{{ result.power_up.GL.starting_level }}</div>
        </div> -->
        {% if not result.inputs.is_valid %}
          <h6>Invalid CP & IV Combo</h4>
        {% else %}
          <div class="row border">
            <div class="col">League</div>
            <div class="col">Rank</div>
            <div class="col">Best CP</div>
            <div class="col">Best Level</div>
            <div class="col">Starting CP</div>
            <div class="col">Power Ups</div>
            <div class="col">Stardust</div>
            <div class="col">Candy</div>
          </div>
          {% if analyze_GL %}
          <div class="row border">
            <div class="col">GL</div>
            <div class="col">{{ result.stats.GL.rank }}</div>
            <div class="col">{{ result.power_up.GL.cp_1500 }}</div>
            <div class="col">{{ result.power_up.GL.level_1500 }}</div>
            <div class="col">{{ result.power_up.GL.starting_cp }}</div>
            <div class="col">{{ result.power_up.GL.power_up_count }}</div>
            <div class="col">{{ result.power_up.GL.stardust_cost }}</div>
            <div class="col">{{ result.power_up.GL.candy_cost }}</div>
          </div>
          {% endif %}
          {% if analyze_UL %}
          <div class="row border">
            <div class="col">UL</div>
            <div class="col">{{ result.stats.UL.rank }}</div>
            <div class="col">{{ result.power_up.UL.cp_2500 }}</div>
            <div class="col">{{ result.power_up.UL.level_2500 }}</div>
            <div class="col">{{ result.power_up.GL.starting_cp }}</div>
            <div class="col">{{ result.power_up.UL.power_up_count }}</div>
            <div class="col">{{ result.power_up.UL.stardust_cost }}</div>
            <div class="col">{{ result.power_up.UL.candy_cost }}</div>
          </div>

          {% endif %}
          {% if analyze_ML %}
          <div class="row border">
            <div class="col">ML</div>
            <div class="col">{{ result.stats.ML.rank }}</div>
            <div class="col">{{ result.power_up.ML.cp_max }}</div>
            <div class="col">{{ result.power_up.ML.level_max }}</div>
            <div class="col">{{ result.power_up.GL.starting_cp }}</div>
            <div class="col">{{ result.power_up.ML.power_up_count }}</div>
            <div class="col">{{ result.power_up.ML.stardust_cost }}</div>
            <div class="col">{{ result.power_up.ML.candy_cost }}</div>
          </div>
          {% endif %}
        {% endif %}
        <br/>
      {% endfor %}
    {% endif %}
  </div>
  <a href="#welcome-link">Back to Top</a>

{% endblock %}